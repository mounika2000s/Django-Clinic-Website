{% extends "base/base.html" %}
{% load static %}

{% block content %}
<div class="container my-5">

  <div class="card shadow-lg p-4 border-0 rounded-3">

    <div class="row g-4 align-items-center">

      <!-- Left side: Image -->
      <div class="col-md-4 text-center">
        {% if doctor.image %}
        <img src="{{ doctor.image.url }}" alt="{{ doctor.full_name }}"
             class="img-fluid rounded-3 shadow-sm"
             style="height: 350px; width: 100%; object-fit: cover; object-position: top;">
        {% else %}
        <img src="{% static 'images/default-doctor.png' %}" alt="No image"
             class="img-fluid rounded-3 shadow-sm"
             style="height: 300px; width: 100%; object-fit: cover;">
        {% endif %}
      </div>

      <!-- Right side: Info -->
      <div class="col-md-8">

        <h2 class="fw-bold">{{ doctor.full_name }}</h2>

        {% if doctor.department %}
        <p class="mb-1"><strong>Department:</strong> {{ doctor.department.name }}</p>
        {% endif %}
        <p class="mb-1"><strong>Email:</strong> {{ doctor.email }}</p>
        <p class="mb-1"><strong>Phone:</strong> {{ doctor.phno }}</p>

        <!-- Buttons -->
        <div class="d-flex flex-wrap gap-2 mt-4">

          <a href="{% url 'view_doctor' %}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Back
          </a>

          {% if user.is_staff %}

            <a href="{% url 'edit_doctor' doctor.id %}" class="btn btn-info text-white">
              <i class="bi bi-pencil-fill"></i> Edit
            </a>

            <a href="{% url 'del_doctor' doctor.id %}" class="btn btn-danger">
              <i class="bi bi-trash"></i> Delete
            </a>

            <!-- Account Status -->
            <div class="d-flex align-items-center">
              {% if not doctor.doctor_profile %}
              <a href="{% url 'create_doctor_account' doctor.id %}" 
                 class="btn btn-primary">
                Create Account
              </a>
              {% else %}
              <span class="badge bg-dark p-2">Account Activated</span>
              {% endif %}
            </div>

          {% endif %}
        </div>
      </div>

    </div>
  </div>

  <!-- CREDENTIALS BOX -->
  {% if user.is_staff %}
  <div class="card shadow-sm mt-4 p-3 border-0 rounded-3">
    <h5 class="fw-bold mb-3">Login Credentials</h5>

    <p class="mb-1">
      <strong>Username:</strong> {{ doctor.doctor_profile.user.username }}
    </p>

    {% if doctor.doctor_profile.password_plain %}
    <p class="mb-1">
      <strong>Password:</strong> {{ doctor.doctor_profile.password_plain }}
    </p>
    {% else %}
    <p class="text-muted"><em>Password is not stored.</em></p>
    {% endif %}
  </div>
  {% endif %}

</div>
{% endblock %}
